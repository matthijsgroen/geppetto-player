#define A 0.017453292519943295
uniform vec2 viewport;uniform vec3 basePosition;uniform vec3 translate;uniform float mutation;uniform vec4 scale;uniform vec2 uMutValues[MAX_MUT];uniform vec4 uMutVectors[MAX_MUT];uniform int uMutParent[MAX_MUT];attribute vec2 coordinates;attribute vec2 aTextureCoord;varying lowp vec2 vTextureCoord;varying lowp float vOpacity;varying lowp float vBrightness;varying lowp float vSaturation;varying lowp float vTargetHue;varying lowp float vTargetSaturation;mat4 B=mat4(2./viewport.x,0,0,0,0,-2./viewport.y,0,0,0,0,1,0,-1,+1,0,1);vec2 C(int D,int E){vec2 F=uMutValues[D];vec2 G=uControlMutIndices[D];int H=int(G.x);int I=int(G.y);if(I==0){return F;}for(int J=0;J<MAX_IT;J++){if(J<I){vec3 K=uMutValueIndices[H+J];float L=uControlValues[int(K.y)];int M=int(floor(K.x+L));int N=int(ceil(K.x+L));float O=L-floor(L);vec2 P=uControlMutValues[M];vec2 Q=uControlMutValues[N];vec2 R=mix(P,Q,O);if(E==2||E==5){F*=R;}else{F+=R;}}else{return F;}}return F;}mat3 S(mat3 T,int D){vec4 mutation=U[D];int E=int(mutation.x);vec2 V=C(D,E);vec2 W=mutation.yz;vec3 F=T[0];vec3 X=T[1];vec3 Y=T[2];if(E==1){float Y=1.;if(mutation.a>0.&&distance(F.xy,W)>mutation.a){Y=0.;}F=vec3(F.xy+V*Y,F.z);}if(E==2){F=vec3(W.xy+vec2((F.x-W.x)*V.x,(F.y-W.y)*V.y),F.z);}if(E==3){float Z=V.x*A;mat2 a=mat2(cos(Z),sin(Z),-sin(Z),cos(Z));F=vec3((F.xy-W)*a+W,F.z);}if(E==4){float Y=1.-clamp(distance(F.xy,W),0.,mutation.a)/mutation.a;F=vec3(F.xy+V*Y,F.z);}if(E==5){float b=V.x;F=vec3(F.xy,F.z*b);}if(E==6){float c=V.x;X=vec3(c,X.yz);}if(E==7){Y=vec3(V.xy,Y.z);}if(E==8){float d=V.x;X=vec3(X.x,d*X.y,X.z);}return mat3(F,X,Y);}mat3 e(mat3 T,int D){int f=D;mat3 F=T;for(int J=0;J<MAX_MUT;J++){if(f==-1){return F;}F=S(F,f);f=uMutParent[f];}return F;}void main(){mat3 g=mat3(coordinates+translate.xy,1.,1.,1.,0,0,0,0);mat3 h=e(g,int(mutation));vec3 i=h[0];vec3 j=h[1];vec3 k=h[2];vec4 l=B*vec4((i.xy+basePosition.xy)*scale.x,translate.z-basePosition.z,1.);gl_Position=vec4((l.xy+scale.ba)*scale.y,l.z,1.);vTextureCoord=aTextureCoord.xy;vOpacity=i.z;vBrightness=j.x;vSaturation=j.y;vTargetHue=k.x;vTargetSaturation=k.y;}